{
	"info": {
		"_postman_id": "ea5acbad-1fb8-4301-acea-fd02cea5141b",
		"name": "Bread Van App_API_Tests_v2",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
		"_exporter_id": "20616724",
		"_collection_link": "https://www.postman.com/manutd-3640/manutd-workspace/collection/k10r241/bread-van-app-api-tests-v2?action=share&source=collection_link&creator=20616724"
	},
	"item": [
		{
			"name": "Auth",
			"item": [
				{
					"name": "Logout (clear tokens)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.environment.unset('admin_token');",
									"pm.environment.unset('driver_token');",
									"pm.environment.unset('resident_token');",
									"pm.test('tokens cleared', () => pm.expect(true).to.eql(true));"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{host}}/api/logout",
							"host": [
								"{{host}}"
							],
							"path": [
								"api",
								"logout"
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "Admin",
			"item": [
				{
					"name": "Create Driver",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status 201', () => pm.response.to.have.status(201));",
									"const json = pm.response.json();",
									"if (json && json.id) { pm.environment.set('created_driver_id', json.id); pm.test('saved driver id', () => pm.expect(json.id).to.be.a('number')); }"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{admin_token}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"username\": \"test_driver_{{randomInt}}\",\n  \"password\": \"pass123\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{host}}/admin/drivers",
							"host": [
								"{{host}}"
							],
							"path": [
								"admin",
								"drivers"
							]
						}
					},
					"response": []
				},
				{
					"name": "Delete Driver (cleanup)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status 204 or 200', () => pm.expect([200,204]).to.include(pm.response.code));"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "DELETE",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{admin_token}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"driver_id\": {{created_driver_id}}\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{host}}/admin/drivers",
							"host": [
								"{{host}}"
							],
							"path": [
								"admin",
								"drivers"
							]
						}
					},
					"response": []
				},
				{
					"name": "Create Area",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status 201', () => pm.response.to.have.status(201));",
									"const json = pm.response.json();",
									"if (json && json.id) { pm.environment.set('created_area_id', json.id); pm.test('saved area id', () => pm.expect(json.id).to.be.a('number')); }"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{admin_token}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"name\": \"test_area_{{randomInt}}\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{host}}/admin/areas",
							"host": [
								"{{host}}"
							],
							"path": [
								"admin",
								"areas"
							]
						}
					},
					"response": []
				},
				{
					"name": "Delete Area (cleanup)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status 204 or 200', () => pm.expect([200,204]).to.include(pm.response.code));"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "DELETE",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{admin_token}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"area_id\": {{created_area_id}}\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{host}}/admin/areas",
							"host": [
								"{{host}}"
							],
							"path": [
								"admin",
								"areas"
							]
						}
					},
					"response": []
				},
				{
					"name": "Create Street",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status 201', () => pm.response.to.have.status(201));",
									"const json = pm.response.json();",
									"if (json && json.id) { pm.environment.set('created_street_id', json.id); pm.test('saved street id', () => pm.expect(json.id).to.be.a('number')); }"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{admin_token}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"area_id\": {{created_area_id}},\n  \"name\": \"test_street_{{randomInt}}\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{host}}/admin/streets",
							"host": [
								"{{host}}"
							],
							"path": [
								"admin",
								"streets"
							]
						}
					},
					"response": []
				},
				{
					"name": "Delete Street (cleanup)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status 204 or 200', () => pm.expect([200,204]).to.include(pm.response.code));"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "DELETE",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{admin_token}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"area_id\": {{created_area_id}},\n  \"street_id\": {{created_street_id}}\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{host}}/admin/streets",
							"host": [
								"{{host}}"
							],
							"path": [
								"admin",
								"streets"
							]
						}
					},
					"response": []
				},
				{
					"name": "Admin Login",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const json = pm.response.json();",
									"if (json && json.access_token) {",
									"  pm.environment.set('admin_token', json.access_token);",
									"  pm.test('admin token set', () => pm.expect(json.access_token).to.be.a('string'));",
									"} else {",
									"  pm.test('access_token present', () => pm.expect(pm.response.code).to.equal(200));",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"username\": \"{{admin_username}}\",\n  \"password\": \"{{admin_password}}\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{host}}/api/login",
							"host": [
								"{{host}}"
							],
							"path": [
								"api",
								"login"
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "Driver",
			"item": [
				{
					"name": "Create Drive",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status 201', () => pm.response.to.have.status(201));",
									"const json = pm.response.json();",
									"if (json && json.id) { pm.environment.set('created_drive_id', json.id); pm.test('saved drive id', () => pm.expect(json.id).to.be.a('number')); }"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{driver_token}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"area_id\": {{created_area_id}},\n  \"street_id\": {{created_street_id}},\n  \"date\": \"2025-12-10\",\n  \"time\": \"09:00\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{host}}/driver/drives",
							"host": [
								"{{host}}"
							],
							"path": [
								"driver",
								"drives"
							]
						}
					},
					"response": []
				},
				{
					"name": "Start Drive",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status 200', () => pm.response.to.have.status(200));"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{driver_token}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"drive_id\": {{created_drive_id}}\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{host}}/driver/drives/start",
							"host": [
								"{{host}}"
							],
							"path": [
								"driver",
								"drives",
								"start"
							]
						}
					},
					"response": []
				},
				{
					"name": "Requested Stops",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status 200', () => pm.response.to.have.status(200));"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{driver_token}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"drive_id\": {{created_drive_id}}\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{host}}/driver/drives/requested-stops",
							"host": [
								"{{host}}"
							],
							"path": [
								"driver",
								"drives",
								"requested-stops"
							]
						}
					},
					"response": []
				},
				{
					"name": "End Drive",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status 200 or 400 depending on state', () => pm.expect([200,400,404]).to.include(pm.response.code));"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{driver_token}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{host}}/driver/drives/end",
							"host": [
								"{{host}}"
							],
							"path": [
								"driver",
								"drives",
								"end"
							]
						}
					},
					"response": []
				},
				{
					"name": "Cancel Drive",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status 200', () => pm.response.to.have.status(200));"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{driver_token}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"drive_id\": {{created_drive_id}}\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{host}}/driver/drives/cancel",
							"host": [
								"{{host}}"
							],
							"path": [
								"driver",
								"drives",
								"cancel"
							]
						}
					},
					"response": []
				},
				{
					"name": "Create/Update Stock",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status 200 or 201', () => pm.expect([200,201]).to.include(pm.response.code));",
									"const json = pm.response.json();",
									"if (json && json.id) { pm.environment.set('created_stock_id', json.id); pm.test('saved stock id', () => pm.expect(json.id).to.be.a('number')); }"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{driver_token}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"item_id\": 1,\n  \"quantity\": 10\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{host}}/driver/stock",
							"host": [
								"{{host}}"
							],
							"path": [
								"driver",
								"stock"
							]
						}
					},
					"response": []
				},
				{
					"name": "Patch Stock",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status 200', () => pm.response.to.have.status(200));"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "PATCH",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{driver_token}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"stock_id\": {{created_stock_id}},\n  \"quantity\": 5\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{host}}/driver/stock",
							"host": [
								"{{host}}"
							],
							"path": [
								"driver",
								"stock"
							]
						}
					},
					"response": []
				},
				{
					"name": "Delete Stock (cleanup)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status 204 or 200', () => pm.expect([200,204]).to.include(pm.response.code));"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "DELETE",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{driver_token}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"stock_id\": {{created_stock_id}}\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{host}}/driver/stock",
							"host": [
								"{{host}}"
							],
							"path": [
								"driver",
								"stock"
							]
						}
					},
					"response": []
				},
				{
					"name": "Notify Residents",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status 200', () => pm.response.to.have.status(200));"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{driver_token}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"message\": \"Test notification from driver\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{host}}/driver/notify",
							"host": [
								"{{host}}"
							],
							"path": [
								"driver",
								"notify"
							]
						}
					},
					"response": []
				},
				{
					"name": "List Subscribers",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status 200', () => pm.response.to.have.status(200));"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{driver_token}}"
							}
						],
						"url": {
							"raw": "{{host}}/driver/subscribers",
							"host": [
								"{{host}}"
							],
							"path": [
								"driver",
								"subscribers"
							]
						}
					},
					"response": []
				},
				{
					"name": "Driver Login",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const json = pm.response.json();",
									"if (json && json.access_token) {",
									"  pm.environment.set('driver_token', json.access_token);",
									"  pm.test('driver token set', () => pm.expect(json.access_token).to.be.a('string'));",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"username\": \"{{driver_username}}\",\n  \"password\": \"{{driver_password}}\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{host}}/api/login",
							"host": [
								"{{host}}"
							],
							"path": [
								"api",
								"login"
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "Resident",
			"item": [
				{
					"name": "Request Stop",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"(function() {",
									"  const id = pm.environment.get('created_drive_id') || pm.environment.get('DRIVE_ID');",
									"  if (!id) {",
									"    // Send an empty JSON body to avoid invalid JSON when the variable is unset",
									"    pm.request.body.raw = JSON.stringify({});",
									"    console.warn('created_drive_id not set; sending empty body');",
									"  } else {",
									"    pm.request.body.raw = JSON.stringify({ drive_id: Number(id) });",
									"  }",
									"})();"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status 201', () => pm.response.to.have.status(201));",
									"if (pm.response.code === 201) {",
									"  try {",
									"    const json = pm.response.json();",
									"    if (json && json.id) {",
									"      pm.environment.set('created_stop_id', json.id);",
									"      pm.test('saved stop id', () => pm.expect(json.id).to.be.a('number'));",
									"    } else {",
									"      pm.test('body contains id', () => pm.expect(json && json.id).to.be.ok);",
									"    }",
									"  } catch (e) {",
									"    pm.test('response JSON parse', () => pm.expect.fail('Response not valid JSON: ' + e));",
									"  }",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{resident_token}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"drive_id\": {{created_drive_id}}\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{host}}/resident/stops",
							"host": [
								"{{host}}"
							],
							"path": [
								"resident",
								"stops"
							]
						}
					},
					"response": []
				},
				{
					"name": "Delete Stop (cleanup)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status 204 or 200', () => pm.expect([200,204]).to.include(pm.response.code));"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "DELETE",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{resident_token}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"drive_id\": {{created_drive_id}}\n}\n",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{host}}/resident/stops",
							"host": [
								"{{host}}"
							],
							"path": [
								"resident",
								"stops"
							]
						}
					},
					"response": []
				},
				{
					"name": "Subscribe to Driver",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status 201', () => pm.response.to.have.status(201));"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{resident_token}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"driver_id\": {{created_driver_id}}\n}\n",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{host}}/resident/subscriptions",
							"host": [
								"{{host}}"
							],
							"path": [
								"resident",
								"subscriptions"
							]
						}
					},
					"response": []
				},
				{
					"name": "Unsubscribe from Driver (cleanup)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status 204 or 200', () => pm.expect([200,204]).to.include(pm.response.code));"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "DELETE",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{resident_token}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"driver_id\": {{created_driver_id}}\n}\n",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{host}}/resident/subscriptions",
							"host": [
								"{{host}}"
							],
							"path": [
								"resident",
								"subscriptions"
							]
						}
					},
					"response": []
				},
				{
					"name": "Verify Notification Flow",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Verify notifications via /driver/notify', function (done) {",
									"  const residentToken = pm.environment.get('resident_token');",
									"  const driverToken = pm.environment.get('driver_token');",
									"  const driverId = pm.environment.get('created_driver_id');",
									"  if (!residentToken || !driverToken || !driverId) { pm.test('missing tokens or driver id', function(){pm.expect.fail('Set resident_token, driver_token, created_driver_id');}); done(); return; }",
									"  // Subscribe as resident",
									"  pm.sendRequest({",
									"    url: pm.environment.get('host') + '/resident/subscriptions',",
									"    method: 'POST',",
									"    header: { 'Authorization': 'Bearer ' + residentToken, 'Content-Type': 'application/json' },",
									"    body: { mode: 'raw', raw: JSON.stringify({ driver_id: Number(driverId) }) }",
									"  }, function (err, res) {",
									"    pm.test('subscribe status 201 or 200', function(){ pm.expect(res).to.have.property('code'); pm.expect([200,201]).to.include(res.code); });",
									"    // Trigger notify as the driver using existing driver with seeded scheduled drive",
									"    pm.sendRequest({",
									"      url: pm.environment.get('host') + '/driver/notify',",
									"      method: 'POST',",
									"      header: { 'Authorization': 'Bearer ' + driverToken, 'Content-Type': 'application/json' },",
									"      body: { mode: 'raw', raw: JSON.stringify({ message: 'Postman notify test' }) }",
									"    }, function (err2, res2) {",
									"      pm.test('notify status 200', function(){ pm.expect(res2).to.have.property('code'); pm.expect(res2.code).to.equal(200); });",
									"      // Now get resident inbox",
									"      pm.sendRequest({",
									"        url: pm.environment.get('host') + '/resident/inbox',",
									"        method: 'GET',",
									"        header: { 'Authorization': 'Bearer ' + residentToken }",
									"      }, function (err3, res3) {",
									"        pm.test('inbox contains notification', function(){",
									"          pm.expect(res3).to.have.property('code'); pm.expect(res3.code).to.equal(200);",
									"          const json = res3.json();",
									"          pm.expect(json).to.have.property('items');",
									"          pm.expect(json.items.length).to.be.above(0);",
									"        });",
									"        done();",
									"      });",
									"    });",
									"  });",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"url": {
							"raw": "{{host}}/resident/inbox",
							"host": [
								"{{host}}"
							],
							"path": [
								"resident",
								"inbox"
							]
						}
					},
					"response": []
				},
				{
					"name": "View Inbox",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status 200', () => pm.response.to.have.status(200));"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{resident_token}}"
							}
						],
						"url": {
							"raw": "{{host}}/resident/inbox",
							"host": [
								"{{host}}"
							],
							"path": [
								"resident",
								"inbox"
							]
						}
					},
					"response": []
				},
				{
					"name": "Resident Login",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const json = pm.response.json();",
									"if (json && json.access_token) {",
									"  pm.environment.set('resident_token', json.access_token);",
									"  pm.test('resident token set', () => pm.expect(json.access_token).to.be.a('string'));",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"username\": \"{{resident_username}}\",\n  \"password\": \"{{resident_password}}\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{host}}/api/login",
							"host": [
								"{{host}}"
							],
							"path": [
								"api",
								"login"
							]
						}
					},
					"response": []
				}
			]
		}
	],
	"variable": [
		{
			"key": "host",
			"value": "http://127.0.0.1:8080"
		},
		{
			"key": "admin_username",
			"value": "admin"
		},
		{
			"key": "admin_password",
			"value": "adminpass"
		},
		{
			"key": "driver_username",
			"value": "bob"
		},
		{
			"key": "driver_password",
			"value": "bobpass"
		},
		{
			"key": "resident_username",
			"value": "alice"
		},
		{
			"key": "resident_password",
			"value": "alicepass"
		}
	]
}